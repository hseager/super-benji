function c(a,b,e){let f=d.g;f.font='60px "Courier New", Roboto, Helvetica, Arial, sans-serif-black';f.textAlign="center";f.strokeStyle="black";f.lineWidth=4;f.strokeText(a,b,e);f.fillStyle="white";f.fillText(a,b,e)}
class h{constructor(){this.g=c2d.getContext("2d");new DOMPoint(0,0);c2d.addEventListener("mousemove",a=>{let b=a.clientX-c2d.getBoundingClientRect().left;a=a.clientY-c2d.getBoundingClientRect().top;new DOMPoint(b,a)});c2d.addEventListener("touchmove",a=>{var b=a.touches[0];a=c2d.getBoundingClientRect();let e=b.clientX-a.left;b=b.clientY-a.top;e*=c2d.width/a.width;b*=c2d.height/a.height;new DOMPoint(e,b)})}get i(){return this.g.canvas.width}get h(){return this.g.canvas.height}}let d=new h;
function l(a){var b=m,e=[];b.g.I?.();b.g=a;b.g.v?.(...e)}class n{constructor(...a){this.g=p;this.g.v?.(...a)}}let m;var q,r=q||(q={});r[r.A=0]="A";r[r.B=1]="B";r[r.X=2]="X";r[r.Y=3]="Y";r[r.LeftBumper=4]="LeftBumper";r[r.RightBumper=5]="RightBumper";r[r.LeftTrigger=6]="LeftTrigger";r[r.RightTrigger=7]="RightTrigger";r[r.Select=8]="Select";r[r.Start=9]="Start";r[r.L3=10]="L3";r[r.R3=11]="R3";r[r.DpadUp=12]="DpadUp";r[r.DpadDown=13]="DpadDown";r[r.DpadLeft=14]="DpadLeft";r[r.DpadRight=15]="DpadRight";
class t{constructor(){this.o=this.l=this.s=this.u=!1;this.g=new Map;this.i={u:this.u,s:this.s,l:this.l,o:this.o};document.addEventListener("keydown",a=>{this.g.set(a.code,!0)});document.addEventListener("keyup",a=>{this.g.set(a.code,!1)});c2d.addEventListener("click",()=>this.l=!0);this.h=new DOMPoint}}let u=new t;class v{v(){}F(){u.o&&l(p)}}let w=new v,x=440*Math.pow(Math.pow(2,1/12),-9),y=/^[0-9.]+$/,z=/\s+/,A=/(\d+)/,B={};
"B#-C C#-Db D D#-Eb E-Fb E#-F F#-Gb G G#-Ab A A#-Bb B-Cb".split(" ").forEach((a,b)=>{a.split("-").forEach(e=>{B[e]=b})});function C(a){return y.test(a)?parseFloat(a):a.toLowerCase().split("").reduce((b,e)=>{switch(e){case "w":return b+4;case "h":return b+2;case "q":return b+1;case "e":return b+.5;case "s":return b+.25;default:return b}},0)}
class D{constructor(a){let [b,e]=a.split(z);a=b.split(A);this.frequency=x*Math.pow(Math.pow(2,1/12),B[a[0]])*Math.pow(2,(parseInt(a[1])||4)-4)||0;this.duration=C(e)||0}}function E(a){let b=a.C;[["bass",100],["mid",1E3],["treble",2500]].forEach(([,e])=>{let f=a.i.createBiquadFilter();f.type="peaking";f.frequency.value=e;b.connect(f);b=f;a.J.push(f)});b.connect(a.H);b.connect(a.D)}function F(a,...b){b.forEach(e=>{a.h.push(e instanceof D?e:new D(e))})}
function G(a,b=a.i.currentTime){a.createOscillator();a.g.start(b);a.h.forEach((e,f)=>{e=b;let k=60/220*a.h[f].duration,g=k*(1-(a.m||1E-11));a.g?.frequency.setValueAtTime(a.h[f].frequency,e);if(a.j&&a.h[f].frequency){let K=a.h[f<a.h.length-1?f+1:0];a.g?.frequency.setValueAtTime(a.h[f].frequency,e+(g-Math.min(g,60/220*a.j)));a.g?.frequency.linearRampToValueAtTime(K.frequency,e+g)}a.g?.frequency.setValueAtTime(0,e+g);b=e+k});a.g.stop(b);a.g.onended=()=>G(a,b)}
class H{constructor(a,b){this.h=[];this.m=this.j=0;this.G="square";this.g=null;this.J=[];this.i=a;this.C=this.i.createGain();this.D=this.i.createGain();this.H=this.i.createGain();E(this);b&&F(this,...b)}createOscillator(){this.stop();this.g=this.i.createOscillator();this.g.type=this.G;this.g.connect(this.C)}connect(a){this.D.connect(a);this.H.connect(a)}stop(){this.g&&(this.g.onended=null,this.g.stop(),this.g.frequency.cancelScheduledValues(0),this.g=null)}}
class I{constructor(){this.volume=.5;this.g=new AudioContext;this.m=this.g.createGain();this.i=this.g.createDynamicsCompressor();this.m.connect(this.g.destination);this.m.gain.value=this.volume;this.i.ratio.value=4;this.i.threshold.value=-12;this.i.connect(this.m);this.j=new H(this.g,"F#4 q;C#5 q;F#4 q;E5 q;- q;E5 q;C#5 q;F#5 q;F#4 q;C#5 q;F#4 q;E5 q;- q;G#4 q;A4 q;B4 q;F#4 q;C#5 q;F#4 q;E5 q;- q;E5 q;C#5 q;F#5 q;F#4 q;C#5 q;F#4 q;E5 q;- q;G#4 q;A4 q;F#4 q;A4 q;E5 q;A4 q;G5 q;- q;E5 q;G5 q;A5 q;A4 q;E5 q;A4 q;G5 q;- q;C5 q;E5 q;C5 q;A4 q;E5 q;A4 q;G5 q;- q;E5 q;G5 q;A5 q;A4 q;E5 q;A4 q;G5 q;A5 q;G5 q;F5 q;D5 q".split(";"));
this.j.m=.3;this.j.j=.02;this.h=new H(this.g,"F#2 h;F#2 h;F#2 h;F#2 h;B1 h;B1 h;C#2 h;C#2 h;F#2 h;F#2 h;F#2 h;F#2 h;B1 h;B1 h;C#2 h;C#2 h;A2 h;A2 h;A2 h;A2 h;E2 h;E2 h;F#2 h;F#2 h;A2 h;A2 h;A2 h;A2 h;E2 h;E2 h;F#2 h;F#2 h".split(";"));this.h.m=.1;this.h.j=.2;this.h.G="sawtooth";this.j.connect(this.i);this.h.connect(this.i)}stop(){this.j.stop();this.h.stop()}}
class J{g(){l(w)}v(){c2d.addEventListener("click",()=>{this.g();var a=new I;let b=a.g.currentTime;G(a.j,b);G(a.h,b)})}F(){let a=d.g.canvas.width/2;c("js13k 2025",a,60);c("Start Game",a,500);u.l&&l(w)}I(){c2d.removeEventListener("click",this.g)}}let p=new J;m=new n(...[]);let L=0,M=1E3/60;
(function N(a){var e=a-L;if(e>=M){L=a-e%M;u.i.u=u.u;u.i.s=u.s;u.i.l=u.l;u.i.o=u.o;a=navigator.getGamepads()[0];e=u.g.get("KeyA")||u.g.get("ArrowLeft")||a?.buttons[14].pressed?-1:0;let f=u.g.get("KeyD")||u.g.get("ArrowRight")||a?.buttons[15].pressed?1:0,k=u.g.get("KeyW")||u.g.get("ArrowUp")||a?.buttons[12].pressed?-1:0,g=u.g.get("KeyS")||u.g.get("ArrowDown")||a?.buttons[13].pressed?1:0;u.h.x=e+f||a?.axes[0]||0;u.h.y=k+g||a?.axes[1]||0;.1>Math.hypot(u.h.x,u.h.y)&&(u.h.x=0,u.h.y=0);u.u=0>u.h.y;u.s=0<
u.h.y;u.l=!!(u.g.get("Enter")||a?.buttons[0].pressed||a?.buttons[9].pressed);u.o=!(!u.g.get("Escape")&&!a?.buttons[8].pressed);d.g.clearRect(0,0,d.i,d.h);m.g.F()}requestAnimationFrame(N)})(0);
