function f(a,b){let c=c2d.getBoundingClientRect();return new DOMPoint(144/c.width*(a-c.left),256/c.height*(b-c.top))}function k(a){let b,c;.5625<window.innerWidth/window.innerHeight?(c=window.innerHeight,b=.5625*c):(b=window.innerWidth,c=b/.5625);a.g.canvas.style.width=`${b}px`;a.g.canvas.style.height=`${c}px`;a.g.imageSmoothingEnabled=!1}
function m(a,b,c,d){let e=n.g;e.font=`${b}px "Courier New", Roboto, Helvetica, Arial, sans-serif-black`;e.textAlign="center";e.strokeStyle="black";e.lineWidth=4;e.strokeText(a,c,d);e.fillStyle="white";e.fillText(a,c,d)}
class p{constructor(){this.g=c2d.getContext("2d");this.h=new DOMPoint(0,0);c2d.addEventListener("mousemove",a=>{this.h=f(a.clientX,a.clientY)});c2d.addEventListener("touchmove",a=>{a=a.touches[0];this.h=f(a.clientX,a.clientY)});c2d.addEventListener("mousedown",()=>!0);c2d.addEventListener("mouseup",()=>!1);c2d.addEventListener("touchstart",()=>{});c2d.addEventListener("touchend",()=>!1);window.addEventListener("resize",()=>k(this));window.addEventListener("orientationchange",()=>k(this));k(this)}get j(){return this.g.canvas.width}get i(){return this.g.canvas.height}}
let n=new p;function q(a){var b=r,c=[];b.g.F?.();b.g=a;b.g.B?.(...c)}class t{constructor(...a){this.g=u;this.g.B?.(...a)}}let r;class v{constructor(){this.u=this.m=this.v=this.A=!1;this.g=new Map;this.i={A:this.A,v:this.v,m:this.m,u:this.u};document.addEventListener("keydown",a=>{this.g.set(a.code,!0)});document.addEventListener("keyup",a=>{this.g.set(a.code,!1)});c2d.addEventListener("click",()=>this.m=!0);this.h=new DOMPoint}}let w=new v,x="#202020 #404040 #606060 #808080 #A0A0A0 #C0C0C0 #00BFFF".split(" ");
class y{constructor(){this.o=100;this.l=2E3;this.i=this.j=this.g=0;this.x=72;this.y=216;this.h=new Image}update(a,b){a-=this.x;b-=this.y;let c=Math.hypot(a,b);1<c&&(this.x+=a/c*1.2,this.y+=b/c*1.2);this.i=this.x-this.j;this.j=this.x}s(a){a.save();a.shadowColor="#0ff";a.shadowBlur=20;var b=this.x,c=this.y-2,d=a.createLinearGradient(b,c,b,c+20);d.addColorStop(0,"rgba(0, 180, 255, 0.9)");d.addColorStop(.4,"rgba(255, 255, 255, 0.8)");d.addColorStop(1,"rgba(255, 140, 0, 0)");var e=5+3*Math.random();a.fillStyle=
d;a.beginPath();a.moveTo(b-1,c);a.lineTo(b,c+e);a.lineTo(b+1,c);a.closePath();a.fill();b=this.h.width;c=this.h.height;d=2*this.i;for(e=0;e<b;e++)a.drawImage(this.h,e,0,1,c,this.x-8+e,this.y-24+Math.floor((e-8)/8*d),1,c);a.restore()}}class z{constructor(a){this.image=a}s(a,b,c,d,e,g,h,l=0){a.save();l&1&&(a.translate(b+g,c),a.scale(-1,1),c=b=0);l&2&&(a.translate(b,c+h),a.scale(1,-1),c=0);a.drawImage(this.image,d,e,g,h,b,c,g,h);a.restore()}}function A(a,b,c,d,e,g,h,l=0){b.s(a.g,c,d,0,e,g,h,l)}
class B{constructor(){this.canvas=document.createElement("canvas");this.canvas.width=40;this.canvas.height=32;this.g=this.canvas.getContext("2d")}}function C(a,b=1){a=parseInt(a.replace("#",""),16);return{r:a>>16&255,D:a>>8&255,b:a&255,alpha:b}}function D(a,b=1){let {r:c,D:d,b:e}=C(a,b);return`rgba(${c}, ${d}, ${e}, ${b})`}function E(a){return new Promise((b,c)=>{a.complete&&0!==a.naturalWidth?b(F(a)):(a.onload=()=>{b(F(a))},a.onerror=c)})}
function F(a){let b=document.createElement("canvas");var c=b.getContext("2d");b.width=a.width;b.height=a.height;c.drawImage(a,0,0);a=c.getImageData(0,0,a.width,a.height);let d=a.data;for(let e=0;e<d.length;e+=4){if(0===d[e+3])continue;let g=C(x[Math.min(x.length-1,Math.floor(d[e]/(256/x.length)))]||"#000000");d[e]=g.r;d[e+1]=g.D;d[e+2]=g.b}c.putImageData(a,0,0);c=new Image;c.src=b.toDataURL();return c}
async function G(a){let b=new B;A(b,a,6,1,16,13,30);A(b,a,0,18,45,6,9);A(b,a,19,18,45,6,9,1);a=new Image;a.src=b.canvas.toDataURL();return await E(a)}let H="#4d592aff #231952ff #38454eff #353550ff #5555FF #5b4949ff".split(" ");
class I{constructor(){this.g=new Image;this.x=this.y=0;this.speed=.4;let a=document.createElement("canvas");a.width=128;a.height=128;var b=a.getContext("2d");b.imageSmoothingEnabled=!1;b.fillStyle="#0a0d1fff";b.fillRect(0,0,128,128);b.globalAlpha=.2;b.globalAlpha=1;for(let c=0;163>c;c++){let d=Math.floor(128*Math.random()),e=Math.floor(128*Math.random());b.fillStyle=H[Math.floor(Math.random()*H.length)];b.beginPath();b.arc(d,e,1,0,2*Math.PI);b.fill()}b=new Image;b.src=a.toDataURL();this.g=b}update(a){this.y+=
this.speed;this.x-=.4*a;this.y>=this.g.height&&(this.y=0)}s(a){let {width:b,height:c}=a.canvas;a.imageSmoothingEnabled=!1;if(this.g.complete){var d=a.createPattern(this.g,"repeat");d&&(a.save(),a.translate(this.x,this.y),a.fillStyle=d,a.fillRect(0,-this.g.height,b+80,c+this.g.height),a.restore(),this.y+=this.speed,this.y>=this.g.height&&(this.y=0))}}}
class J{constructor(a,b){this.speed=1;this.x=a;this.y=b}update(){this.y-=this.speed}s(a,b="#cccccc"){let c=a.createRadialGradient(this.x,this.y,0,this.x,this.y,2);c.addColorStop(0,D(b,1));c.addColorStop(.5,D(b,.5));c.addColorStop(1,D(b,0));a.fillStyle=c;a.beginPath();a.arc(this.x,this.y,3,0,2*Math.PI);a.fill();a.fillStyle=b;a.beginPath();a.arc(this.x,this.y,1,0,2*Math.PI);a.fill()}}
class K{constructor(){this.h=[];this.g=new y;let a=new Image;a.src="iVBORw0KGgoAAAANSUhEUgAAAEAAAABYCAMAAAByMgEaAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAThQTFRFAAAATExMSUlJX19fUVFRZmZmUFBQIyMjTk5OLy8vODg4NjY2ZGRkbGxsQUFBR0dHNzc3a2trZ2dnQkJCKysrOzs7Xl5eLS0tYWFhV1dXaGhob29vREREJiYmVFRUOjo6cXFxPj4+ISEhSkpKVVVVFxcXWlpaYmJiaWlpFhYWNTU1dnZ2k5OTGRkZiYmJe3t7Y2NjCwsLJSUlNDQ0cnJyiIiIkZGReHh4S0tLVlZWDg4OCQkJmJiYCAgIfHx8EhISf39/WVlZHBwcjIyMKCgoSEhIFBQUPz8/tra2Hh4ejo6OoaGhMTExIyMjKioqQ0NDERERlJSUgoKCuLi4ICAgfn5+dHR0lpaWBgYGhISEGBgYIiIiGhoaICAgBQUFFxcXJiYmFRUVwcHBJycnJycnqKioCgoKIiIiS71T+gAAAGh0Uk5TAP///////////////////////////////////////////////////////////////x3///////////9V/3H///////////////////+N/////////////xj/qnHjGC+Oo1X/uuP/OB8TpO42AAACMUlEQVR4nO2X15LaQBAAVzkLRQQSOWcwGYyPcITLOTln+///wHC+H/CMH+kqHrthZ2vFipC/mCmC4zGEDKj8R5R/bhsuKpAYKjIqcKhR3zF+8jobi/OIwL1pZBwdEejxJ7m4fQbVW+xMb3KCYmdh/mGg0Z7lZzo+w30B+OqB71+GVDXjRJhU9Pe/B6IFa55r8OxFWi7kTMAveEbzOvFPUHnHkhDnCeEnCYv5+u1GkAEu8O1nHxe4va2+QgWOjhiUH5qcihIm0GRKURmzhokdSLHXiMBb92FhvEEEalJh3EH4fJMprp338CGIxYvIWIj/Agc2YaE1XbThQzD4OJMvH5ehaxDNUc4QyoIL3cjHU75055RjQ2hgcr0SrPH6kgIO4cdglmQX1NSlz0H+sCh3lRlLX4WMjg0JMGnppNLX9PWmLdGQgEgv+3Ktq1/peQn0z7SKKYHdUI1puu6Bnqyq6N5QzZiSl+vLKCywCjOtMyefFpQwJDCi07rF2V5deqeAlrC9lyjasJ0R2oRQkMAOM1+pO1B5R/jY++phAjL5TD5gApnt5w4T6BcxNiHzKnj8W5jt5oUqiECXrj1UkojAjdYLBy1EYNAIUnPQKXrBPJCtBGaIBYT7DIcNvIB95yI1pH+v4fzYAeqORUhVx82yQZdQ98SeGC3lEP6ASqkRxBJ62cCKmCWwXx2l/Ajnw9+cs12rEI4k4Q81muU2iZELP480Kya2ByEBDuzZs2fPnv/HH9MfOmHqf1LYAAAAAElFTkSuQmCC";let b=
new z(a);a.onload=async()=>{let c=await G(b);this.g.h=c};this.i=new I}}class L{B(){c2d.addEventListener("click",()=>{window.location.reload()})}C(){let a=n.g.canvas.width/2;m("You Lose!",80,a,90);m("Back to Menu",60,a,400);w.m&&window.location.reload()}}let M=440*Math.pow(Math.pow(2,1/12),-9),N=/^[0-9.]+$/,O=/\s+/,P=/(\d+)/,Q={};"B#-C C#-Db D D#-Eb E-Fb E#-F F#-Gb G G#-Ab A A#-Bb B-Cb".split(" ").forEach((a,b)=>{a.split("-").forEach(c=>{Q[c]=b})});
function R(a){return N.test(a)?parseFloat(a):a.toLowerCase().split("").reduce((b,c)=>{switch(c){case "w":return b+4;case "h":return b+2;case "q":return b+1;case "e":return b+.5;case "s":return b+.25;default:return b}},0)}class S{constructor(a){let [b,c]=a.split(O);a=b.split(P);this.frequency=M*Math.pow(Math.pow(2,1/12),Q[a[0]])*Math.pow(2,(parseInt(a[1])||4)-4)||0;this.duration=R(c)||0}}
function T(a){let b=a.o;[["bass",100],["mid",1E3],["treble",2500]].forEach(([,c])=>{let d=a.i.createBiquadFilter();d.type="peaking";d.frequency.value=c;b.connect(d);b=d;a.J.push(d)});b.connect(a.I);b.connect(a.G)}function aa(a,...b){b.forEach(c=>{a.h.push(c instanceof S?c:new S(c))})}
function U(a,b=a.i.currentTime){a.createOscillator();a.g.start(b);a.h.forEach((c,d)=>{c=b;let e=60/220*a.h[d].duration,g=e*(1-(a.l||1E-11));a.g?.frequency.setValueAtTime(a.h[d].frequency,c);if(a.j&&a.h[d].frequency){let h=a.h[d<a.h.length-1?d+1:0];a.g?.frequency.setValueAtTime(a.h[d].frequency,c+(g-Math.min(g,60/220*a.j)));a.g?.frequency.linearRampToValueAtTime(h.frequency,c+g)}a.g?.frequency.setValueAtTime(0,c+g);b=c+e});a.g.stop(b);a.g.onended=()=>U(a,b)}
class V{constructor(a,b){this.h=[];this.l=this.j=0;this.H="square";this.g=null;this.J=[];this.i=a;this.o=this.i.createGain();this.G=this.i.createGain();this.I=this.i.createGain();T(this);b&&aa(this,...b)}createOscillator(){this.stop();this.g=this.i.createOscillator();this.g.type=this.H;this.g.connect(this.o)}connect(a){this.G.connect(a);this.I.connect(a)}stop(){this.g&&(this.g.onended=null,this.g.stop(),this.g.frequency.cancelScheduledValues(0),this.g=null)}}
function W(a){if(!a.j){var b=a.g.currentTime;U(a.l,b);U(a.h,b);a.j=!0}}
class ba{constructor(){this.volume=.5;this.j=!1;this.g=new AudioContext;this.o=this.g.createGain();this.i=this.g.createDynamicsCompressor();this.o.connect(this.g.destination);this.o.gain.value=this.volume;this.i.ratio.value=4;this.i.threshold.value=-12;this.i.connect(this.o);this.l=new V(this.g,"F#4 q;C#5 q;F#4 q;E5 q;- q;E5 q;C#5 q;F#5 q;F#4 q;C#5 q;F#4 q;E5 q;- q;G#4 q;A4 q;B4 q;F#4 q;C#5 q;F#4 q;E5 q;- q;E5 q;C#5 q;F#5 q;F#4 q;C#5 q;F#4 q;E5 q;- q;G#4 q;A4 q;F#4 q;A4 q;E5 q;A4 q;G5 q;- q;E5 q;G5 q;A5 q;A4 q;E5 q;A4 q;G5 q;- q;C5 q;E5 q;C5 q;A4 q;E5 q;A4 q;G5 q;- q;E5 q;G5 q;A5 q;A4 q;E5 q;A4 q;G5 q;A5 q;G5 q;F5 q;D5 q".split(";"));this.l.l=
.3;this.l.j=.02;this.h=new V(this.g,"F#2 h;F#2 h;F#2 h;F#2 h;B1 h;B1 h;C#2 h;C#2 h;F#2 h;F#2 h;F#2 h;F#2 h;B1 h;B1 h;C#2 h;C#2 h;A2 h;A2 h;A2 h;A2 h;E2 h;E2 h;F#2 h;F#2 h;A2 h;A2 h;A2 h;A2 h;E2 h;E2 h;F#2 h;F#2 h".split(";"));this.h.l=.1;this.h.j=.2;this.h.H="sawtooth";this.l.connect(this.i);this.h.connect(this.i)}stop(){this.l.stop();this.h.stop();this.j=!1}}
function ca(a){W(a.g);a.h.classList.remove("hide");a.h.textContent=a.g.j?"\ud83d\udd08":"\ud83d\udd07";a.h.addEventListener("click",()=>{a.g.j?(a.g.stop(),a.h.textContent="\ud83d\udd07"):(W(a.g),a.h.textContent="\ud83d\udd08")})}
class da{constructor(){this.j=n.g;this.i=new K;this.h=document.querySelector(".mute-button");this.g=new ba}B(){this.i=new K;ca(this)}C(a){let b=n.h,{i:c,g:d,h:e}=this.i;c?.update(this.i.g.i);c?.s(this.j);d?.update(b.x,b.y);d?.s(this.j);let {g,l:h}=d;0<g&&(d.g-=a);0>=d.g&&(this.i.h.push(new J(d.x,d.y-16)),d.g=h);e.forEach((l,ea)=>{l.update();l.s(this.j);0>l.y+1&&e.splice(ea,1)});w.u&&q(u);0>=this.i.g?.o&&q(new L)}F(){this.h.classList.add("hide");this.g.stop()}}let X=new da;
class fa{g(){q(X)}B(){c2d.addEventListener("click",this.g)}C(){let a=n.g.canvas.width/2;m("js13k 2025",16,a,60);m("Start Game",16,a,200);w.m&&q(X)}F(){c2d.removeEventListener("click",this.g)}}let u=new fa;r=new t(...[]);let Y=0,Z=1E3/60;
(function ha(a){let c=a-Y;if(c>=Z){Y=a-c%Z;w.i.A=w.A;w.i.v=w.v;w.i.m=w.m;w.i.u=w.u;a=w.g.get("KeyA")||w.g.get("ArrowLeft")?-1:0;let d=w.g.get("KeyD")||w.g.get("ArrowRight")?1:0,e=w.g.get("KeyW")||w.g.get("ArrowUp")?-1:0,g=w.g.get("KeyS")||w.g.get("ArrowDown")?1:0;w.h.x=a+d||0;w.h.y=e+g||0;.1>Math.hypot(w.h.x,w.h.y)&&(w.h.x=0,w.h.y=0);w.A=0>w.h.y;w.v=0<w.h.y;w.m=!!w.g.get("Enter");w.u=!!w.g.get("Escape");n.g.clearRect(0,0,n.j,n.i);r.g.C(c)}requestAnimationFrame(ha)})(0);
