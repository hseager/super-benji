function g(a,b){let c=c2d.getBoundingClientRect();return new DOMPoint(144/c.width*(a-c.left),256/c.height*(b-c.top))}function l(a){let b,c;.5625<window.innerWidth/window.innerHeight?(c=window.innerHeight,b=.5625*c):(b=window.innerWidth,c=b/.5625);a.g.canvas.style.width=`${b}px`;a.g.canvas.style.height=`${c}px`;a.g.imageSmoothingEnabled=!1}
function m(a,b,c,d){let e=n.g;e.font=`${b}px "Courier New", Roboto, Helvetica, Arial, sans-serif-black`;e.textAlign="center";e.strokeStyle="black";e.lineWidth=4;e.strokeText(a,c,d);e.fillStyle="white";e.fillText(a,c,d)}
class p{constructor(){this.g=c2d.getContext("2d");this.h=new DOMPoint(0,0);c2d.addEventListener("mousemove",a=>{this.h=g(a.clientX,a.clientY)});c2d.addEventListener("touchmove",a=>{a=a.touches[0];this.h=g(a.clientX,a.clientY)});c2d.addEventListener("mousedown",()=>!0);c2d.addEventListener("mouseup",()=>!1);c2d.addEventListener("touchstart",()=>{});c2d.addEventListener("touchend",()=>!1);window.addEventListener("resize",()=>l(this));window.addEventListener("orientationchange",()=>l(this));l(this)}get i(){return this.g.canvas.width}get j(){return this.g.canvas.height}}
let n=new p;function q(a){var b=r,c=[];b.g.C?.();b.g=a;b.g.s?.(...c)}class t{constructor(...a){this.g=u;this.g.s?.(...a)}}let r;class w{constructor(){this.g=!1;this.h=new Map;document.addEventListener("keydown",a=>{this.h.set(a.code,!0)});document.addEventListener("keyup",a=>{this.h.set(a.code,!1)});c2d.addEventListener("click",()=>this.g=!0);new DOMPoint}}let x=new w,y="#202020 #404040 #606060 #808080 #A0A0A0 #C0C0C0 #00BFFF".split(" ");
class z{constructor(){this.v=100;this.l=2;this.i=this.j=this.g=0;this.u="#00bfff7c";this.m=12;this.x=72;this.y=224;this.h=new Image}update(a,b){a-=this.x;b-=this.y;let c=Math.hypot(a,b);1<c&&(this.x+=a/c*1.2,this.y+=b/c*1.2);this.i=this.x-this.j;this.j=this.x}o(a){a.save();a.shadowColor=this.u;a.shadowBlur=this.m;var b=this.x+1,c=this.y,d=a.createLinearGradient(b,c,b,c+20);d.addColorStop(0,"rgba(0, 180, 255, 0.9)");d.addColorStop(.4,"rgba(255, 255, 255, 0.8)");d.addColorStop(1,"rgba(255, 140, 0, 0)");
var e=9+3*Math.random();a.fillStyle=d;a.beginPath();a.moveTo(b-1,c);a.lineTo(b,c+e);a.lineTo(b+1,c);a.closePath();a.fill();b=this.h.width;c=this.h.height;d=2*this.i;e=b/2;for(let f=0;f<b;f++)a.drawImage(this.h,f,0,1,c,this.x-12+f,this.y-28+Math.floor((f-e)/e*d),1,c);a.restore()}}class A{constructor(a){this.image=a}o(a,b,c,d,e,f,h,k=0){a.save();k&1&&(a.translate(b+f,c),a.scale(-1,1),c=b=0);k&2&&(a.translate(b,c+h),a.scale(1,-1),c=0);a.drawImage(this.image,d,e,f,h,b,c,f,h);a.restore()}}
function B(a,b,c,d,e,f,h,k=0){b.o(a.g,c,d,0,e,f,h,k)}class C{constructor(){this.canvas=document.createElement("canvas");this.canvas.width=27;this.canvas.height=32;this.g=this.canvas.getContext("2d")}}function D(a,b=1){a=parseInt(a.replace("#",""),16);return{r:a>>16&255,B:a>>8&255,b:a&255,alpha:b}}function E(a,b=1){let {r:c,B:d,b:e}=D(a,b);return`rgba(${c}, ${d}, ${e}, ${b})`}function F(a){return new Promise((b,c)=>{a.complete&&0!==a.naturalWidth?b(G(a)):(a.onload=()=>{b(G(a))},a.onerror=c)})}
function G(a){let b=document.createElement("canvas");var c=b.getContext("2d");b.width=a.width;b.height=a.height;c.drawImage(a,0,0);a=c.getImageData(0,0,a.width,a.height);let d=a.data;for(let e=0;e<d.length;e+=4){if(0===d[e+3])continue;let f=D(y[Math.min(y.length-1,Math.floor(d[e]/(256/y.length)))]||"#000000");d[e]=f.r;d[e+1]=f.B;d[e+2]=f.b}c.putImageData(a,0,0);c=new Image;c.src=b.toDataURL();return c}
async function H(a){let b=new C;B(b,a,7,0,15,13,30);B(b,a,1,18,45,6,9);B(b,a,19,18,45,6,9,1);a=new Image;a.src=b.canvas.toDataURL();return await F(a)}let I="#4d592aff #231952ff #38454eff #353550ff #5555FF #5b4949ff".split(" ");
class J{constructor(){this.g=new Image;this.x=this.y=0;this.speed=.4;let a=document.createElement("canvas");a.width=128;a.height=128;var b=a.getContext("2d");b.imageSmoothingEnabled=!1;b.fillStyle="#0a0d1fff";b.fillRect(0,0,128,128);b.globalAlpha=.2;b.globalAlpha=1;for(let c=0;163>c;c++){let d=Math.floor(128*Math.random()),e=Math.floor(128*Math.random());b.fillStyle=I[Math.floor(Math.random()*I.length)];b.beginPath();b.arc(d,e,1,0,2*Math.PI);b.fill()}b=new Image;b.src=a.toDataURL();this.g=b}update(a){this.y+=
this.speed;this.x-=.4*a;this.y>=this.g.height&&(this.y=0)}o(a){let {width:b,height:c}=a.canvas;a.imageSmoothingEnabled=!1;if(this.g.complete){var d=a.createPattern(this.g,"repeat");d&&(a.save(),a.translate(this.x,this.y),a.fillStyle=d,a.fillRect(0,-this.g.height,b+80,c+this.g.height),a.restore(),this.y+=this.speed,this.y>=this.g.height&&(this.y=0))}}}
class K{constructor(a,b){this.speed=1;this.x=a;this.y=b}update(){this.y-=this.speed}o(a,b="#cccccc"){let c=a.createRadialGradient(this.x,this.y,0,this.x,this.y,2);c.addColorStop(0,E(b,1));c.addColorStop(.5,E(b,.5));c.addColorStop(1,E(b,0));a.fillStyle=c;a.beginPath();a.arc(this.x,this.y,3,0,2*Math.PI);a.fill();a.fillStyle=b;a.beginPath();a.arc(this.x,this.y,1,0,2*Math.PI);a.fill()}}function L(a,b){a.h=b;a.g=2}
class M{constructor(){this.h=1;this.g=0}update(a){0<this.g&&(this.g-=a,a=n.g,a.save(),a.font="24px monospace",a.fillStyle="white",a.textAlign="center",a.fillText(`LEVEL ${this.h}`,n.i/2,80),a.restore())}}
class N{constructor(){this.i=[];let a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABYCAMAAAByMgEaAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEtQTFRFAAAAKCgoU1NTSUlJMzMzQUFBOjo6ZWVlbGxsd3d3ERERi4uLHR0dXV1dl5eXxMTEsLCwCgoKICAgCQkJ////ISEhYGBg3NzcIyMjvz39MwAAABl0Uk5TAP/+//////////////////9hkSP/HKX/1VEFYkAAAAMrSURBVHic7VfZdts6DBQ2guAiOa4b9/+/tJAsOU56cwtZffQ8OFSOOAQGC6FhuCHn4RETDDsx0uNTFy47CRR/3rmGQQx5GHDH/rOktC6zn62yEOywAok3gisMYGSAA+wQomb6tS67KlU1AE0c3p9GEri5TIRZ6uUKKYmEfbCcGsiyBEqEenIVGeKhqFgR5GYxF8i1y4U4rIGiiSmwLLnQUsNOCSFsQM2ZQLWxdj17DrShIIMHJWiBmqqQE4D27Okkvg0X8ylGgF27S+AapI5zRWwJ8bEIILvmP9b13ipY4MbeCZ5B+lI4df5pOwjqYF/sWf5MYYLpVB+elnSYTcoSJTid7EOBcbYdT7MJ9O2OPwj6fZ3Uz+1X9cROKRhJGke6l651YBwnxQKEQR/MUzBtPpg3lzyOIwIrUiwpRsksb6s1SILdxktPSEQxE2qyllYCb8iA0qcJU+IWlHHkXjYNcK4l0Or17RJCSEW0rgXONxHaHETONSO4/zECUtDStlpwC4rXJ6W5ruE9QiB9IVhFcNmEXIYisjwE4O2rt9LKPRldB/a+RMHSpoyYoMAWB16ryaINxXMmNyhCb/d/LSEJ30uex03LJ4Jd+GWWsFFJdP5kQLSjkCZjz/9CiTfN1+YQu949dSvX7FEDXvMW7CZAjmURQU2jOUHbCMwtyT4c1CAB+22syQnW+3lIvU/qt3XsZlJKPk4I+5UIa1sSpMmUSwqpqES9K4MT8NbXAOt0Iog1E+8f4pcjND7z4kJZinGa3KgYwfw+QWtw6+fv/gPZrnarxhhJbtw2wcZSq1idLnQBIYrVQ2/8thGYorB5UwVtEh1S0nAetiEto0Ahu6J3BCaIDWpt+Eh89u42vPvQ45OKexbToOrDA/qewijLlJi/2/IJ3R6btz0eGpCge/Dok6d75oL5QBqN90xDX1F9qsz69/e+t8DHxL7ny+ArsiW/hA8Q9L+/8v844v4jjjixYDy432I5+y3I4p9H/22AHNOyUj4Uzeofakdy0SirHnChzvvz81EwnM/X5wuaTP1mSs+74J+p4jPS86nss/FczUei8MILL7zwwr/Cb3olFq8dbo59AAAAAElFTkSuQmCC";let b=
new A(a);this.h=new z;this.g=new M;this.j=new J;a.onload=async()=>{let c=await H(b);this.h.h=c}}}class O{s(){c2d.addEventListener("click",()=>{window.location.reload()})}A(){let a=n.g.canvas.width/2;m("You Lose!",80,a,90);m("Back to Menu",60,a,400);x.g&&window.location.reload()}}let P=440*Math.pow(Math.pow(2,1/12),-9),Q=/^[0-9.]+$/,R=/\s+/,S=/(\d+)/,T={};"B#-C C#-Db D D#-Eb E-Fb E#-F F#-Gb G G#-Ab A A#-Bb B-Cb".split(" ").forEach((a,b)=>{a.split("-").forEach(c=>{T[c]=b})});
function aa(a){return Q.test(a)?parseFloat(a):a.toLowerCase().split("").reduce((b,c)=>{switch(c){case "w":return b+4;case "h":return b+2;case "q":return b+1;case "e":return b+.5;case "s":return b+.25;default:return b}},0)}class U{constructor(a){let [b,c]=a.split(R);a=b.split(S);this.frequency=P*Math.pow(Math.pow(2,1/12),T[a[0]])*Math.pow(2,(parseInt(a[1])||4)-4)||0;this.duration=aa(c)||0}}
function ba(a){let b=a.m;[["bass",100],["mid",1E3],["treble",2500]].forEach(([,c])=>{let d=a.i.createBiquadFilter();d.type="peaking";d.frequency.value=c;b.connect(d);b=d;a.F.push(d)});b.connect(a.D);b.connect(a.u)}function ca(a,...b){b.forEach(c=>{a.h.push(c instanceof U?c:new U(c))})}
function V(a,b=a.i.currentTime){a.createOscillator();a.g.start(b);a.h.forEach((c,d)=>{c=b;let e=60/220*a.h[d].duration,f=e*(1-(a.l||1E-11));a.g?.frequency.setValueAtTime(a.h[d].frequency,c);if(a.j&&a.h[d].frequency){let h=a.h[d<a.h.length-1?d+1:0];a.g?.frequency.setValueAtTime(a.h[d].frequency,c+(f-Math.min(f,60/220*a.j)));a.g?.frequency.linearRampToValueAtTime(h.frequency,c+f)}a.g?.frequency.setValueAtTime(0,c+f);b=c+e});a.g.stop(b);a.g.onended=()=>V(a,b)}
class W{constructor(a,b){this.h=[];this.l=this.j=0;this.v="square";this.g=null;this.F=[];this.i=a;this.m=this.i.createGain();this.u=this.i.createGain();this.D=this.i.createGain();ba(this);b&&ca(this,...b)}createOscillator(){this.stop();this.g=this.i.createOscillator();this.g.type=this.v;this.g.connect(this.m)}connect(a){this.u.connect(a);this.D.connect(a)}stop(){this.g&&(this.g.onended=null,this.g.stop(),this.g.frequency.cancelScheduledValues(0),this.g=null)}}
function X(a){if(!a.j){var b=a.g.currentTime;V(a.l,b);V(a.h,b);a.j=!0}}
class da{constructor(){this.volume=.15;this.j=!1;this.g=new AudioContext;this.m=this.g.createGain();this.i=this.g.createDynamicsCompressor();this.m.connect(this.g.destination);this.m.gain.value=this.volume;this.i.ratio.value=4;this.i.threshold.value=-12;this.i.connect(this.m);this.l=new W(this.g,"F#4 q;C#5 q;F#4 q;E5 q;- q;E5 q;C#5 q;F#5 q;F#4 q;C#5 q;F#4 q;E5 q;- q;G#4 q;A4 q;B4 q;F#4 q;C#5 q;F#4 q;E5 q;- q;E5 q;C#5 q;F#5 q;F#4 q;C#5 q;F#4 q;E5 q;- q;G#4 q;A4 q;F#4 q;A4 q;E5 q;A4 q;G5 q;- q;E5 q;G5 q;A5 q;A4 q;E5 q;A4 q;G5 q;- q;C5 q;E5 q;C5 q;A4 q;E5 q;A4 q;G5 q;- q;E5 q;G5 q;A5 q;A4 q;E5 q;A4 q;G5 q;A5 q;G5 q;F5 q;D5 q".split(";"));this.l.l=
.3;this.l.j=.02;this.h=new W(this.g,"F#2 h;F#2 h;F#2 h;F#2 h;B1 h;B1 h;C#2 h;C#2 h;F#2 h;F#2 h;F#2 h;F#2 h;B1 h;B1 h;C#2 h;C#2 h;A2 h;A2 h;A2 h;A2 h;E2 h;E2 h;F#2 h;F#2 h;A2 h;A2 h;A2 h;A2 h;E2 h;E2 h;F#2 h;F#2 h".split(";"));this.h.l=.1;this.h.j=.2;this.h.v="sawtooth";this.l.connect(this.i);this.h.connect(this.i)}stop(){this.l.stop();this.h.stop();this.j=!1}}
function ea(a){X(a.g);a.h.classList.remove("hide");a.h.textContent=a.g.j?"\ud83d\udd08":"\ud83d\udd07";a.h.addEventListener("click",()=>{a.g.j?(a.g.stop(),a.h.textContent="\ud83d\udd07"):(X(a.g),a.h.textContent="\ud83d\udd08")})}
class fa{constructor(){this.j=n.g;this.i=new N;this.h=document.querySelector(".mute-button");this.g=new da}s(){ea(this);L(this.i.g,1);setTimeout(()=>{var a=this.i.g;L(a,a.h+1)},4E3)}A(a){let b=n.h,{j:c,h:d,i:e,g:f}=this.i;c?.update(d.i);c?.o(this.j);d?.update(b.x,b.y);d?.o(this.j);let {g:h,l:k}=d;0<h&&(d.g-=a);0>=d.g&&(this.i.i.push(new K(d.x+1,d.y-24)),d.g=k);e.forEach((v,ha)=>{v.update();v.o(this.j);0>v.y+1&&e.splice(ha,1)});f.update(a);0>=this.i.h?.v&&q(new O)}C(){this.h.classList.add("hide");
this.g.stop()}}let Y=new fa;class ia{g(){q(Y)}s(){c2d.addEventListener("click",this.g)}A(){let a=n.g.canvas.width/2;m("js13k 2025",16,a,60);m("Start Game",16,a,200);x.g&&q(Y)}C(){c2d.removeEventListener("click",this.g)}}let u=new ia;r=new t(...[]);let Z=performance.now();(()=>{function a(b){let c=(b-Z)/1E3;Z=b;n.g.clearRect(0,0,n.i,n.j);r.g.A(c);requestAnimationFrame(a)}requestAnimationFrame(a)})();
